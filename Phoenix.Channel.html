<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.21.2">
    <meta name="project" content="Phoenix v1.4.15">
    <title>Phoenix.Channel â€” Phoenix v1.4.15</title>
    <link rel="stylesheet" href="dist/html-de2388dc2f8074b0a4db.css" />
    <script src="dist/sidebar_items-c08200cd71.js"></script>
      <script src="docs_config.js"></script>
    <script async src="dist/html-de2388dc2f8074b0a4db.js"></script>
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button">
      <span class="icon-cross" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Search" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="http://www.phoenixframework.org" class="sidebar-projectName">
Phoenix      </a>
      <h2 class="sidebar-projectVersion">
        v1.4.15
      </h2>
    </div>
      <a href="http://www.phoenixframework.org">
        <img src="assets/logo.png" alt="Phoenix" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">GUIDES</a></li>

      <li><a id="modules-list" href="#full-list">Modules</a></li>

      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>

      <li><a id="tasks-list" href="#full-list">Mix Tasks</a></li>
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
        <small class="app-vsn">Phoenix v1.4.15</small>
Phoenix.Channel <small>behaviour</small>          <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>
      </h1>


        <section id="moduledoc">
<p>Defines a Phoenix Channel.</p>
<p>Channels provide a means for bidirectional communication from clients that
integrate with the <a href="https://hexdocs.pm/phoenix_pubsub/1.1.2/Phoenix.PubSub.html"><code class="inline">Phoenix.PubSub</code></a> layer for soft-realtime functionality.</p>
<h2 id="module-topics-callbacks" class="section-heading">
  <a href="#module-topics-callbacks" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Topics &amp; Callbacks
</h2>

<p>Every time you join a channel, you need to choose which particular topic you
want to listen to. The topic is just an identifier, but by convention it is
often made of two parts: <code class="inline">&quot;topic:subtopic&quot;</code>. Using the <code class="inline">&quot;topic:subtopic&quot;</code>
approach pairs nicely with the <a href="Phoenix.Socket.html#channel/3"><code class="inline">Phoenix.Socket.channel/3</code></a> allowing you to
match on all topics starting with a given prefix by using a splat (the <code class="inline">*</code>
character) as the last character in the topic pattern:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">channel</span><span class="w"> </span><span class="s">&quot;room:*&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.RoomChannel</span></code></pre>
<p>Any topic coming into the router with the <code class="inline">&quot;room:&quot;</code> prefix would dispatch
to <code class="inline">MyApp.RoomChannel</code> in the above example. Topics can also be pattern
matched in your channels&#39; <code class="inline">join/3</code> callback to pluck out the scoped pattern:</p>
<pre><code class="nohighlight makeup elixir"><span class="c1"># handles the special `&quot;lobby&quot;` subtopic</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="1058788365-1">(</span><span class="s">&quot;room:lobby&quot;</span><span class="p">,</span><span class="w"> </span><span class="c">_payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1058788365-1">)</span><span class="w"> </span><span class="k" data-group-id="1058788365-2">do</span><span class="w">
  </span><span class="p" data-group-id="1058788365-3">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1058788365-3">}</span><span class="w">
</span><span class="k" data-group-id="1058788365-2">end</span><span class="w">

</span><span class="c1"># handles any other subtopic as the room ID, for example `&quot;room:12&quot;`, `&quot;room:34&quot;`</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="1058788365-4">(</span><span class="s">&quot;room:&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">room_id</span><span class="p">,</span><span class="w"> </span><span class="c">_payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1058788365-4">)</span><span class="w"> </span><span class="k" data-group-id="1058788365-5">do</span><span class="w">
  </span><span class="p" data-group-id="1058788365-6">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1058788365-6">}</span><span class="w">
</span><span class="k" data-group-id="1058788365-5">end</span></code></pre>
<h2 id="module-authorization" class="section-heading">
  <a href="#module-authorization" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Authorization
</h2>

<p>Clients must join a channel to send and receive PubSub events on that channel.
Your channels must implement a <code class="inline">join/3</code> callback that authorizes the socket
for the given topic. For example, you could check if the user is allowed to
join that particular room.</p>
<p>To authorize a socket in <code class="inline">join/3</code>, return <code class="inline">{:ok, socket}</code>.
To refuse authorization in <code class="inline">join/3</code>, return <code class="inline">{:error, reply}</code>.</p>
<h2 id="module-incoming-events" class="section-heading">
  <a href="#module-incoming-events" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Incoming Events
</h2>

<p>After a client has successfully joined a channel, incoming events from the
client are routed through the channel&#39;s <code class="inline">handle_in/3</code> callbacks. Within these
callbacks, you can perform any action. Typically you&#39;ll either forward a
message to all listeners with <a href="#broadcast!/3"><code class="inline">broadcast!/3</code></a>, or push a message directly down
the socket with <a href="#push/3"><code class="inline">push/3</code></a>. Incoming callbacks must return the <code class="inline">socket</code> to
maintain ephemeral state.</p>
<p>Here&#39;s an example of receiving an incoming <code class="inline">&quot;new_msg&quot;</code> event from one client,
and broadcasting the message to all topic subscribers for this socket.</p>
<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="2719123324-1">(</span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2719123324-2">%{</span><span class="s">&quot;uid&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;body&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="2719123324-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="2719123324-1">)</span><span class="w"> </span><span class="k" data-group-id="2719123324-3">do</span><span class="w">
  </span><span class="n">broadcast!</span><span class="p" data-group-id="2719123324-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2719123324-5">%{</span><span class="ss">uid</span><span class="p">:</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="2719123324-5">}</span><span class="p" data-group-id="2719123324-4">)</span><span class="w">
  </span><span class="p" data-group-id="2719123324-6">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="2719123324-6">}</span><span class="w">
</span><span class="k" data-group-id="2719123324-3">end</span></code></pre>
<p>You can also push a message directly down the socket:</p>
<pre><code class="nohighlight makeup elixir"><span class="c1"># client asks for their current rank, push sent directly as a new event.</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="8688240464-1">(</span><span class="s">&quot;current_rank&quot;</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8688240464-1">)</span><span class="w"> </span><span class="k" data-group-id="8688240464-2">do</span><span class="w">
  </span><span class="n">push</span><span class="p" data-group-id="8688240464-3">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;current_rank&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8688240464-4">%{</span><span class="ss">val</span><span class="p">:</span><span class="w"> </span><span class="nc">Game</span><span class="o">.</span><span class="n">get_rank</span><span class="p" data-group-id="8688240464-5">(</span><span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="p" data-group-id="8688240464-6">[</span><span class="ss">:user</span><span class="p" data-group-id="8688240464-6">]</span><span class="p" data-group-id="8688240464-5">)</span><span class="p" data-group-id="8688240464-4">}</span><span class="p" data-group-id="8688240464-3">)</span><span class="w">
  </span><span class="p" data-group-id="8688240464-7">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8688240464-7">}</span><span class="w">
</span><span class="k" data-group-id="8688240464-2">end</span></code></pre>
<h2 id="module-replies" class="section-heading">
  <a href="#module-replies" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Replies
</h2>

<p>In addition to pushing messages out when you receive a <code class="inline">handle_in</code> event,
you can also reply directly to a client event for request/response style
messaging. This is useful when a client must know the result of an operation
or to simply ack messages.</p>
<p>For example, imagine creating a resource and replying with the created record:</p>
<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="8731237322-1">(</span><span class="s">&quot;create:post&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8731237322-1">)</span><span class="w"> </span><span class="k" data-group-id="8731237322-2">do</span><span class="w">
  </span><span class="n">changeset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Post</span><span class="o">.</span><span class="n">changeset</span><span class="p" data-group-id="8731237322-3">(</span><span class="p" data-group-id="8731237322-4">%</span><span class="nc" data-group-id="8731237322-4">Post</span><span class="p" data-group-id="8731237322-4">{</span><span class="p" data-group-id="8731237322-4">}</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p" data-group-id="8731237322-3">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">changeset</span><span class="o">.</span><span class="n">valid?</span><span class="w"> </span><span class="k" data-group-id="8731237322-5">do</span><span class="w">
    </span><span class="n">post</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Repo</span><span class="o">.</span><span class="n">insert!</span><span class="p" data-group-id="8731237322-6">(</span><span class="n">changeset</span><span class="p" data-group-id="8731237322-6">)</span><span class="w">
    </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">MyApp.PostView</span><span class="o">.</span><span class="n">render</span><span class="p" data-group-id="8731237322-7">(</span><span class="s">&quot;show.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8731237322-8">%{</span><span class="ss">post</span><span class="p">:</span><span class="w"> </span><span class="n">post</span><span class="p" data-group-id="8731237322-8">}</span><span class="p" data-group-id="8731237322-7">)</span><span class="w">
    </span><span class="p" data-group-id="8731237322-9">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8731237322-10">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="8731237322-10">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8731237322-9">}</span><span class="w">
  </span><span class="k" data-group-id="8731237322-5">else</span><span class="w">
    </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">MyApp.ChangesetView</span><span class="o">.</span><span class="n">render</span><span class="p" data-group-id="8731237322-11">(</span><span class="s">&quot;errors.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8731237322-12">%{</span><span class="ss">changeset</span><span class="p">:</span><span class="w"> </span><span class="n">changeset</span><span class="p" data-group-id="8731237322-12">}</span><span class="p" data-group-id="8731237322-11">)</span><span class="w">
    </span><span class="p" data-group-id="8731237322-13">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8731237322-14">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="8731237322-14">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="8731237322-13">}</span><span class="w">
  </span><span class="k" data-group-id="8731237322-5">end</span><span class="w">
</span><span class="k" data-group-id="8731237322-2">end</span></code></pre>
<p>Alternatively, you may just want to ack the status of the operation:</p>
<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="3529799757-1">(</span><span class="s">&quot;create:post&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3529799757-1">)</span><span class="w"> </span><span class="k" data-group-id="3529799757-2">do</span><span class="w">
  </span><span class="n">changeset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Post</span><span class="o">.</span><span class="n">changeset</span><span class="p" data-group-id="3529799757-3">(</span><span class="p" data-group-id="3529799757-4">%</span><span class="nc" data-group-id="3529799757-4">Post</span><span class="p" data-group-id="3529799757-4">{</span><span class="p" data-group-id="3529799757-4">}</span><span class="p">,</span><span class="w"> </span><span class="n">attrs</span><span class="p" data-group-id="3529799757-3">)</span><span class="w">

  </span><span class="k">if</span><span class="w"> </span><span class="n">changeset</span><span class="o">.</span><span class="n">valid?</span><span class="w"> </span><span class="k" data-group-id="3529799757-5">do</span><span class="w">
    </span><span class="nc">Repo</span><span class="o">.</span><span class="n">insert!</span><span class="p" data-group-id="3529799757-6">(</span><span class="n">changeset</span><span class="p" data-group-id="3529799757-6">)</span><span class="w">
    </span><span class="p" data-group-id="3529799757-7">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3529799757-7">}</span><span class="w">
  </span><span class="k" data-group-id="3529799757-5">else</span><span class="w">
    </span><span class="p" data-group-id="3529799757-8">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3529799757-8">}</span><span class="w">
  </span><span class="k" data-group-id="3529799757-5">end</span><span class="w">
</span><span class="k" data-group-id="3529799757-2">end</span></code></pre>
<h2 id="module-intercepting-outgoing-events" class="section-heading">
  <a href="#module-intercepting-outgoing-events" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Intercepting Outgoing Events
</h2>

<p>When an event is broadcasted with <a href="#broadcast/3"><code class="inline">broadcast/3</code></a>, each channel subscriber can
choose to intercept the event and have their <code class="inline">handle_out/3</code> callback triggered.
This allows the event&#39;s payload to be customized on a socket by socket basis
to append extra information, or conditionally filter the message from being
delivered. If the event is not intercepted with <a href="Phoenix.Channel.html#intercept/1"><code class="inline">Phoenix.Channel.intercept/1</code></a>,
then the message is pushed directly to the client:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">intercept</span><span class="w"> </span><span class="p" data-group-id="1175944782-1">[</span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;user_joined&quot;</span><span class="p" data-group-id="1175944782-1">]</span><span class="w">

</span><span class="c1"># for every socket subscribing to this topic, append an `is_editable`</span><span class="w">
</span><span class="c1"># value for client metadata.</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_out</span><span class="p" data-group-id="1175944782-2">(</span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1175944782-2">)</span><span class="w"> </span><span class="k" data-group-id="1175944782-3">do</span><span class="w">
  </span><span class="n">push</span><span class="p" data-group-id="1175944782-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Map</span><span class="o">.</span><span class="n">merge</span><span class="p" data-group-id="1175944782-5">(</span><span class="n">msg</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1175944782-6">%{</span><span class="ss">is_editable</span><span class="p">:</span><span class="w"> </span><span class="nc">User</span><span class="o">.</span><span class="n">can_edit_message?</span><span class="p" data-group-id="1175944782-7">(</span><span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="p" data-group-id="1175944782-8">[</span><span class="ss">:user</span><span class="p" data-group-id="1175944782-8">]</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p" data-group-id="1175944782-7">)</span><span class="p" data-group-id="1175944782-6">}</span><span class="w">
  </span><span class="p" data-group-id="1175944782-5">)</span><span class="p" data-group-id="1175944782-4">)</span><span class="w">
  </span><span class="p" data-group-id="1175944782-9">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1175944782-9">}</span><span class="w">
</span><span class="k" data-group-id="1175944782-3">end</span><span class="w">

</span><span class="c1"># do not send broadcasted `&quot;user_joined&quot;` events if this socket&#39;s user</span><span class="w">
</span><span class="c1"># is ignoring the user who joined.</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_out</span><span class="p" data-group-id="1175944782-10">(</span><span class="s">&quot;user_joined&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1175944782-10">)</span><span class="w"> </span><span class="k" data-group-id="1175944782-11">do</span><span class="w">
  </span><span class="k">unless</span><span class="w"> </span><span class="nc">User</span><span class="o">.</span><span class="n">ignoring?</span><span class="p" data-group-id="1175944782-12">(</span><span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="p" data-group-id="1175944782-13">[</span><span class="ss">:user</span><span class="p" data-group-id="1175944782-13">]</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="o">.</span><span class="n">user_id</span><span class="p" data-group-id="1175944782-12">)</span><span class="w"> </span><span class="k" data-group-id="1175944782-14">do</span><span class="w">
    </span><span class="n">push</span><span class="p" data-group-id="1175944782-15">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;user_joined&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p" data-group-id="1175944782-15">)</span><span class="w">
  </span><span class="k" data-group-id="1175944782-14">end</span><span class="w">
  </span><span class="p" data-group-id="1175944782-16">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="1175944782-16">}</span><span class="w">
</span><span class="k" data-group-id="1175944782-11">end</span></code></pre>
<h2 id="module-broadcasting-to-an-external-topic" class="section-heading">
  <a href="#module-broadcasting-to-an-external-topic" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Broadcasting to an external topic
</h2>

<p>In some cases, you will want to broadcast messages without the context of
a <code class="inline">socket</code>. This could be for broadcasting from within your channel to an
external topic, or broadcasting from elsewhere in your application like a
controller or another process. Such can be done via your endpoint:</p>
<pre><code class="nohighlight makeup elixir"><span class="c1"># within channel</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="7937997644-1">(</span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7937997644-2">%{</span><span class="s">&quot;uid&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;body&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="7937997644-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7937997644-1">)</span><span class="w"> </span><span class="k" data-group-id="7937997644-3">do</span><span class="w">
  </span><span class="n">...</span><span class="w">
  </span><span class="n">broadcast_from!</span><span class="p" data-group-id="7937997644-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7937997644-5">%{</span><span class="ss">uid</span><span class="p">:</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="7937997644-5">}</span><span class="p" data-group-id="7937997644-4">)</span><span class="w">
  </span><span class="nc">MyApp.Endpoint</span><span class="o">.</span><span class="n">broadcast_from!</span><span class="p" data-group-id="7937997644-6">(</span><span class="n">self</span><span class="p" data-group-id="7937997644-7">(</span><span class="p" data-group-id="7937997644-7">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;room:superadmin&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7937997644-8">%{</span><span class="ss">uid</span><span class="p">:</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="7937997644-8">}</span><span class="p" data-group-id="7937997644-6">)</span><span class="w">
  </span><span class="p" data-group-id="7937997644-9">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7937997644-9">}</span><span class="w">
</span><span class="k" data-group-id="7937997644-3">end</span><span class="w">

</span><span class="c1"># within controller</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">create</span><span class="p" data-group-id="7937997644-10">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p" data-group-id="7937997644-10">)</span><span class="w"> </span><span class="k" data-group-id="7937997644-11">do</span><span class="w">
  </span><span class="n">...</span><span class="w">
  </span><span class="nc">MyApp.Endpoint</span><span class="o">.</span><span class="n">broadcast!</span><span class="p" data-group-id="7937997644-12">(</span><span class="s">&quot;room:&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">rid</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7937997644-13">%{</span><span class="ss">uid</span><span class="p">:</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="7937997644-13">}</span><span class="p" data-group-id="7937997644-12">)</span><span class="w">
  </span><span class="nc">MyApp.Endpoint</span><span class="o">.</span><span class="n">broadcast!</span><span class="p" data-group-id="7937997644-14">(</span><span class="s">&quot;room:superadmin&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7937997644-15">%{</span><span class="ss">uid</span><span class="p">:</span><span class="w"> </span><span class="n">uid</span><span class="p">,</span><span class="w"> </span><span class="ss">body</span><span class="p">:</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="7937997644-15">}</span><span class="p" data-group-id="7937997644-14">)</span><span class="w">
  </span><span class="n">redirect</span><span class="p" data-group-id="7937997644-16">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="ss">to</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="7937997644-16">)</span><span class="w">
</span><span class="k" data-group-id="7937997644-11">end</span></code></pre>
<h2 id="module-terminate" class="section-heading">
  <a href="#module-terminate" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Terminate
</h2>

<p>On termination, the channel callback <code class="inline">terminate/2</code> will be invoked with
the error reason and the socket.</p>
<p>If we are terminating because the client left, the reason will be
<code class="inline">{:shutdown, :left}</code>. Similarly, if we are terminating because the
client connection was closed, the reason will be <code class="inline">{:shutdown, :closed}</code>.</p>
<p>If any of the callbacks return a <code class="inline">:stop</code> tuple, it will also
trigger terminate with the reason given in the tuple.</p>
<p><code class="inline">terminate/2</code>, however, won&#39;t be invoked in case of errors nor in
case of exits. This is the same behaviour as you find in Elixir
abstractions like <a href="https://hexdocs.pm/elixir/GenServer.html"><code class="inline">GenServer</code></a> and others. Typically speaking, if you
want to clean something up, it is better to monitor your channel
process and do the clean up from another process.  Similar to GenServer,
it would also be possible <code class="inline">:trap_exit</code> to guarantee that <code class="inline">terminate/2</code>
is invoked. This practice is not encouraged though.</p>
<h2 id="module-exit-reasons-when-stopping-a-channel" class="section-heading">
  <a href="#module-exit-reasons-when-stopping-a-channel" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Exit reasons when stopping a channel
</h2>

<p>When the channel callbacks return a <code class="inline">:stop</code> tuple, such as:</p>
<pre><code class="nohighlight makeup elixir"><span class="p" data-group-id="3476767999-1">{</span><span class="ss">:stop</span><span class="p">,</span><span class="w"> </span><span class="ss">:shutdown</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3476767999-1">}</span><span class="w">
</span><span class="p" data-group-id="3476767999-2">{</span><span class="ss">:stop</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3476767999-3">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="ss">:enoent</span><span class="p" data-group-id="3476767999-3">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3476767999-2">}</span></code></pre>
<p>the second argument is the exit reason, which follows the same behaviour as
standard <a href="https://hexdocs.pm/elixir/GenServer.html"><code class="inline">GenServer</code></a> exits.</p>
<p>You have three options to choose from when shutting down a channel:</p>
<ul>
<li><p><code class="inline">:normal</code> - in such cases, the exit won&#39;t be logged and linked processes
do not exit</p>
</li>
<li><p><code class="inline">:shutdown</code> or <code class="inline">{:shutdown, term}</code> - in such cases, the exit won&#39;t be
logged and linked processes exit with the same reason unless they&#39;re
trapping exits</p>
</li>
<li><p>any other term - in such cases, the exit will be logged and linked
processes exit with the same reason unless they&#39;re trapping exits</p>
</li>
</ul>
<h2 id="module-subscribing-to-external-topics" class="section-heading">
  <a href="#module-subscribing-to-external-topics" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Subscribing to external topics
</h2>

<p>Sometimes you may need to programmatically subscribe a socket to external
topics in addition to the internal <code class="inline">socket.topic</code>. For example,
imagine you have a bidding system where a remote client dynamically sets
preferences on products they want to receive bidding notifications on.
Instead of requiring a unique channel process and topic per
preference, a more efficient and simple approach would be to subscribe a
single channel to relevant notifications via your endpoint. For example:</p>
<pre><code class="nohighlight makeup elixir"><span class="kd">defmodule</span><span class="w"> </span><span class="nc">MyApp.Endpoint.NotificationChannel</span><span class="w"> </span><span class="k" data-group-id="0850644016-1">do</span><span class="w">
  </span><span class="kn">use</span><span class="w"> </span><span class="nc">Phoenix.Channel</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="0850644016-2">(</span><span class="s">&quot;notification:&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-3">%{</span><span class="s">&quot;ids&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ids</span><span class="p" data-group-id="0850644016-3">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="0850644016-2">)</span><span class="w"> </span><span class="k" data-group-id="0850644016-4">do</span><span class="w">
    </span><span class="n">topics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">product_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ids</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;product:</span><span class="si" data-group-id="0850644016-5">#{</span><span class="n">product_id</span><span class="si" data-group-id="0850644016-5">}</span><span class="s">&quot;</span><span class="w">

    </span><span class="p" data-group-id="0850644016-6">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="w">
          </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">assign</span><span class="p" data-group-id="0850644016-7">(</span><span class="ss">:topics</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-8">[</span><span class="p" data-group-id="0850644016-8">]</span><span class="p" data-group-id="0850644016-7">)</span><span class="w">
          </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_new_topics</span><span class="p" data-group-id="0850644016-9">(</span><span class="n">topics</span><span class="p" data-group-id="0850644016-9">)</span><span class="p" data-group-id="0850644016-6">}</span><span class="w">
  </span><span class="k" data-group-id="0850644016-4">end</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="0850644016-10">(</span><span class="s">&quot;watch&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-11">%{</span><span class="s">&quot;product_id&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">id</span><span class="p" data-group-id="0850644016-11">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="0850644016-10">)</span><span class="w"> </span><span class="k" data-group-id="0850644016-12">do</span><span class="w">
    </span><span class="p" data-group-id="0850644016-13">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">put_new_topics</span><span class="p" data-group-id="0850644016-14">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-15">[</span><span class="s">&quot;product:</span><span class="si" data-group-id="0850644016-16">#{</span><span class="n">id</span><span class="si" data-group-id="0850644016-16">}</span><span class="s">&quot;</span><span class="p" data-group-id="0850644016-15">]</span><span class="p" data-group-id="0850644016-14">)</span><span class="p" data-group-id="0850644016-13">}</span><span class="w">
  </span><span class="k" data-group-id="0850644016-12">end</span><span class="w">

  </span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="0850644016-17">(</span><span class="s">&quot;unwatch&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-18">%{</span><span class="s">&quot;product_id&quot;</span><span class="w"> </span><span class="o">=</span><span class="o">&gt;</span><span class="w"> </span><span class="n">id</span><span class="p" data-group-id="0850644016-18">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="0850644016-17">)</span><span class="w"> </span><span class="k" data-group-id="0850644016-19">do</span><span class="w">
    </span><span class="p" data-group-id="0850644016-20">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="nc">MyApp.Endpoint</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p" data-group-id="0850644016-21">(</span><span class="s">&quot;product:</span><span class="si" data-group-id="0850644016-22">#{</span><span class="n">id</span><span class="si" data-group-id="0850644016-22">}</span><span class="s">&quot;</span><span class="p" data-group-id="0850644016-21">)</span><span class="p" data-group-id="0850644016-20">}</span><span class="w">
  </span><span class="k" data-group-id="0850644016-19">end</span><span class="w">

  </span><span class="kd">defp</span><span class="w"> </span><span class="nf">put_new_topics</span><span class="p" data-group-id="0850644016-23">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">topics</span><span class="p" data-group-id="0850644016-23">)</span><span class="w"> </span><span class="k" data-group-id="0850644016-24">do</span><span class="w">
    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="p" data-group-id="0850644016-25">(</span><span class="n">topics</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="0850644016-26">fn</span><span class="w"> </span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="n">acc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
      </span><span class="n">topics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acc</span><span class="o">.</span><span class="n">assigns</span><span class="o">.</span><span class="n">topics</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="n">topic</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">topics</span><span class="w"> </span><span class="k" data-group-id="0850644016-27">do</span><span class="w">
        </span><span class="n">acc</span><span class="w">
      </span><span class="k" data-group-id="0850644016-27">else</span><span class="w">
        </span><span class="ss">:ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">MyApp.Endpoint</span><span class="o">.</span><span class="n">subscribe</span><span class="p" data-group-id="0850644016-28">(</span><span class="n">topic</span><span class="p" data-group-id="0850644016-28">)</span><span class="w">
        </span><span class="n">assign</span><span class="p" data-group-id="0850644016-29">(</span><span class="n">acc</span><span class="p">,</span><span class="w"> </span><span class="ss">:topics</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0850644016-30">[</span><span class="n">topic</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">topics</span><span class="p" data-group-id="0850644016-30">]</span><span class="p" data-group-id="0850644016-29">)</span><span class="w">
      </span><span class="k" data-group-id="0850644016-27">end</span><span class="w">
    </span><span class="k" data-group-id="0850644016-26">end</span><span class="p" data-group-id="0850644016-25">)</span><span class="w">
  </span><span class="k" data-group-id="0850644016-24">end</span><span class="w">
</span><span class="k" data-group-id="0850644016-1">end</span></code></pre>
<p>Note: the caller must be responsible for preventing duplicate subscriptions.
After calling <code class="inline">subscribe/1</code> from your endpoint, the same flow applies to
handling regular Elixir messages within your channel. Most often, you&#39;ll
simply relay the <code class="inline">%Phoenix.Socket.Broadcast{}</code> event and payload:</p>
<pre><code class="nohighlight makeup elixir"><span class="kn">alias</span><span class="w"> </span><span class="nc">Phoenix.Socket.Broadcast</span><span class="w">
</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_info</span><span class="p" data-group-id="0977262521-1">(</span><span class="p" data-group-id="0977262521-2">%</span><span class="nc" data-group-id="0977262521-2">Broadcast</span><span class="p" data-group-id="0977262521-2">{</span><span class="ss">topic</span><span class="p">:</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="ss">event</span><span class="p">:</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="ss">payload</span><span class="p">:</span><span class="w"> </span><span class="n">payload</span><span class="p" data-group-id="0977262521-2">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="0977262521-1">)</span><span class="w"> </span><span class="k" data-group-id="0977262521-3">do</span><span class="w">
  </span><span class="n">push</span><span class="p" data-group-id="0977262521-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p" data-group-id="0977262521-4">)</span><span class="w">
  </span><span class="p" data-group-id="0977262521-5">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="0977262521-5">}</span><span class="w">
</span><span class="k" data-group-id="0977262521-3">end</span></code></pre>
<h2 id="module-hibernation" class="section-heading">
  <a href="#module-hibernation" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Hibernation
</h2>

<p>From Erlang/OTP 20, channels automatically hibernate to save memory
after 15_000 milliseconds of inactivity. This can be customized by
passing the <code class="inline">:hibernate_after</code> option to <code class="inline">use Phoenix.Channel</code>:</p>
<pre><code class="nohighlight makeup elixir"><span class="kn">use</span><span class="w"> </span><span class="nc">Phoenix.Channel</span><span class="p">,</span><span class="w"> </span><span class="ss">hibernate_after</span><span class="p">:</span><span class="w"> </span><span class="mi">60_000</span></code></pre>
<p>You can also set it to <code class="inline">:infinity</code> to fully disable it.</p>
<h2 id="module-logging" class="section-heading">
  <a href="#module-logging" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Logging
</h2>

<p>By default, channel <code class="inline">&quot;join&quot;</code> and <code class="inline">&quot;handle_in&quot;</code> events are logged, using
the level <code class="inline">:info</code> and <code class="inline">:debug</code>, respectively. Logs can be customized per
event type or disabled by setting the <code class="inline">:log_join</code> and <code class="inline">:log_handle_in</code>
options when using <a href="#content"><code class="inline">Phoenix.Channel</code></a>. For example, the following
configuration logs join events as <code class="inline">:info</code>, but disables logging for
incoming events:</p>
<pre><code class="nohighlight makeup elixir"><span class="kn">use</span><span class="w"> </span><span class="nc">Phoenix.Channel</span><span class="p">,</span><span class="w"> </span><span class="ss">log_join</span><span class="p">:</span><span class="w"> </span><span class="ss">:info</span><span class="p">,</span><span class="w"> </span><span class="ss">log_handle_in</span><span class="p">:</span><span class="w"> </span><span class="no">false</span></code></pre>
        </section>

        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
  <div class="summary-types summary">
    <h2>
      <a href="#types">Types</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:reply/0">reply()</a>
  </div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#t:socket_ref/0">socket_ref()</a>
  </div>
</div>
  </div>
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#broadcast/3">broadcast(socket, event, message)</a>
  </div>
    <div class="summary-synopsis"><p>Broadcast an event to all subscribers of the socket topic.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#broadcast!/3">broadcast!(socket, event, message)</a>
  </div>
    <div class="summary-synopsis"><p>Same as <a href="#broadcast/3"><code class="inline">broadcast/3</code></a>, but raises if broadcast fails.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#broadcast_from/3">broadcast_from(socket, event, message)</a>
  </div>
    <div class="summary-synopsis"><p>Broadcast event from pid to all subscribers of the socket topic.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#broadcast_from!/3">broadcast_from!(socket, event, message)</a>
  </div>
    <div class="summary-synopsis"><p>Same as <a href="#broadcast_from/3"><code class="inline">broadcast_from/3</code></a>, but raises if broadcast fails.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#intercept/1">intercept(events)</a>
  </div>
    <div class="summary-synopsis"><p>Defines which Channel events to intercept for <code class="inline">handle_out/3</code> callbacks.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#push/3">push(socket, event, message)</a>
  </div>
    <div class="summary-synopsis"><p>Sends event to the socket.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#reply/2">reply(socket_ref, status)</a>
  </div>
    <div class="summary-synopsis"><p>Replies asynchronously to a socket push.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#socket_ref/1">socket_ref(socket)</a>
  </div>
    <div class="summary-synopsis"><p>Generates a <code class="inline">socket_ref</code> for an async reply.</p></div>
</div>
  </div>
  <div class="summary-callbacks summary">
    <h2>
      <a href="#callbacks">Callbacks</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:code_change/3">code_change(old_vsn, arg2, extra)</a>
  </div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:handle_call/3">handle_call(msg, from, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Handle regular GenServer call messages.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:handle_cast/2">handle_cast(msg, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Handle regular GenServer cast messages.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:handle_in/3">handle_in(event, payload, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Handle incoming <code class="inline">event</code>s.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:handle_info/2">handle_info(msg, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Handle regular Elixir process messages.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:handle_out/3">handle_out(event, payload, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Intercepts outgoing <code class="inline">event</code>s.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:join/3">join(topic, payload, socket)</a>
  </div>
    <div class="summary-synopsis"><p>Handle channel joins by <code class="inline">topic</code>.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#c:terminate/2">terminate(reason, arg2)</a>
  </div>
    <div class="summary-synopsis"><p>Invoked when the channel process is about to exit.</p></div>
</div>
  </div>
        </section>

        <section id="types" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#types">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Types          </h1>
          <div class="types-list">
<section class="detail" id="t:reply/0">
  <div class="detail-header">
    <a href="#t:reply/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">reply()</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L276" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>reply() :: status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | {status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), response :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
  </section>
</section>
<section class="detail" id="t:socket_ref/0">
  <div class="detail-header">
    <a href="#t:socket_ref/0" class="detail-link" title="Link to this type">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this type</span>
    </a>
    <h1 class="signature">socket_ref()</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L277" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>socket_ref() ::
  {transport_pid :: Pid, serializer :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), topic :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(),
   ref :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), join_ref :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
  </section>
</section>
          </div>
        </section>
        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions          </h1>
          <div class="functions-list">
<section class="detail" id="broadcast/3">
  <div class="detail-header">
    <a href="#broadcast/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">broadcast(socket, event, message)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L478" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Broadcast an event to all subscribers of the socket topic.</p>
<p>The event&#39;s message must be a serializable map.</p>
<h2 id="broadcast/3-examples" class="section-heading">
  <a href="#broadcast/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">broadcast</span><span class="p" data-group-id="1849114840-1">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_message&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1849114840-2">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p" data-group-id="1849114840-2">}</span><span class="p" data-group-id="1849114840-1">)</span><span class="w">
</span><span class="ss">:ok</span></code></pre>
  </section>
</section>
<section class="detail" id="broadcast!/3">
  <div class="detail-header">
    <a href="#broadcast!/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">broadcast!(socket, event, message)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L486" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Same as <a href="#broadcast/3"><code class="inline">broadcast/3</code></a>, but raises if broadcast fails.</p>
  </section>
</section>
<section class="detail" id="broadcast_from/3">
  <div class="detail-header">
    <a href="#broadcast_from/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">broadcast_from(socket, event, message)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L503" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Broadcast event from pid to all subscribers of the socket topic.</p>
<p>The channel that owns the socket will not receive the published
message. The event&#39;s message must be a serializable map.</p>
<h2 id="broadcast_from/3-examples" class="section-heading">
  <a href="#broadcast_from/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">broadcast_from</span><span class="p" data-group-id="6331785297-1">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_message&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6331785297-2">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p" data-group-id="6331785297-2">}</span><span class="p" data-group-id="6331785297-1">)</span><span class="w">
</span><span class="ss">:ok</span></code></pre>
  </section>
</section>
<section class="detail" id="broadcast_from!/3">
  <div class="detail-header">
    <a href="#broadcast_from!/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">broadcast_from!(socket, event, message)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L513" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Same as <a href="#broadcast_from/3"><code class="inline">broadcast_from/3</code></a>, but raises if broadcast fails.</p>
  </section>
</section>
<section class="detail" id="intercept/1">
  <div class="detail-header">
    <a href="#intercept/1" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">intercept(events)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L445" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Defines which Channel events to intercept for <code class="inline">handle_out/3</code> callbacks.</p>
<p>By default, broadcasted events are pushed directly to the client, but
intercepting events gives your channel a chance to customize the event
for the client to append extra information or filter the message from being
delivered.</p>
<p><em>Note</em>: intercepting events can introduce significantly more overhead if a
large number of subscribers must customize a message since the broadcast will
be encoded N times instead of a single shared encoding across all subscribers.</p>
<h2 id="intercept/1-examples" class="section-heading">
  <a href="#intercept/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">intercept</span><span class="w"> </span><span class="p" data-group-id="7684301598-1">[</span><span class="s">&quot;new_msg&quot;</span><span class="p" data-group-id="7684301598-1">]</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_out</span><span class="p" data-group-id="7684301598-2">(</span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7684301598-2">)</span><span class="w"> </span><span class="k" data-group-id="7684301598-3">do</span><span class="w">
  </span><span class="n">push</span><span class="p" data-group-id="7684301598-4">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_msg&quot;</span><span class="p">,</span><span class="w"> </span><span class="nc">Map</span><span class="o">.</span><span class="n">merge</span><span class="p" data-group-id="7684301598-5">(</span><span class="n">payload</span><span class="p">,</span><span class="w">
    </span><span class="ss">is_editable</span><span class="p">:</span><span class="w"> </span><span class="nc">User</span><span class="o">.</span><span class="n">can_edit_message?</span><span class="p" data-group-id="7684301598-6">(</span><span class="n">socket</span><span class="o">.</span><span class="n">assigns</span><span class="p" data-group-id="7684301598-7">[</span><span class="ss">:user</span><span class="p" data-group-id="7684301598-7">]</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p" data-group-id="7684301598-6">)</span><span class="w">
  </span><span class="p" data-group-id="7684301598-5">)</span><span class="p" data-group-id="7684301598-4">)</span><span class="w">
  </span><span class="p" data-group-id="7684301598-8">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="7684301598-8">}</span><span class="w">
</span><span class="k" data-group-id="7684301598-3">end</span></code></pre>
<p><code class="inline">handle_out/3</code> callbacks must return one of:</p>
<pre><code class="nohighlight makeup elixir"><span class="p" data-group-id="5617333033-1">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="nc">Socket</span><span class="o">.</span><span class="n">t</span><span class="p" data-group-id="5617333033-1">}</span><span class="w"> </span><span class="o">|</span><span class="w">
</span><span class="p" data-group-id="5617333033-2">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="nc">Socket</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="ss">:hibernate</span><span class="p" data-group-id="5617333033-2">}</span><span class="w"> </span><span class="o">|</span><span class="w">
</span><span class="p" data-group-id="5617333033-3">{</span><span class="ss">:stop</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">term</span><span class="p">,</span><span class="w"> </span><span class="nc">Socket</span><span class="o">.</span><span class="n">t</span><span class="p" data-group-id="5617333033-3">}</span></code></pre>
  </section>
</section>
<section class="detail" id="push/3">
  <div class="detail-header">
    <a href="#push/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">push(socket, event, message)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L531" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Sends event to the socket.</p>
<p>The event&#39;s message must be a serializable map.</p>
<h2 id="push/3-examples" class="section-heading">
  <a href="#push/3-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="gp unselectable">iex&gt; </span><span class="n">push</span><span class="p" data-group-id="5531543206-1">(</span><span class="n">socket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;new_message&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5531543206-2">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hello&quot;</span><span class="p" data-group-id="5531543206-2">}</span><span class="p" data-group-id="5531543206-1">)</span><span class="w">
</span><span class="ss">:ok</span></code></pre>
  </section>
</section>
<section class="detail" id="reply/2">
  <div class="detail-header">
    <a href="#reply/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">reply(socket_ref, status)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L565" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>reply(<a href="#t:socket_ref/0">socket_ref</a>(), <a href="#t:reply/0">reply</a>()) :: :ok</pre>
      </div>
  </div>
  <section class="docstring">
<p>Replies asynchronously to a socket push.</p>
<p>Useful when you need to reply to a push that can&#39;t otherwise be handled using
the <code class="inline">{:reply, {status, payload}, socket}</code> return from your <code class="inline">handle_in</code>
callbacks. <a href="#reply/2"><code class="inline">reply/2</code></a> will be used in the rare cases you need to perform work in
another process and reply when finished by generating a reference to the push
with <a href="#socket_ref/1"><code class="inline">socket_ref/1</code></a>.</p>
<p><em>Note</em>: In such cases, a <code class="inline">socket_ref</code> should be generated and
passed to the external process, so the <code class="inline">socket</code> itself is not leaked outside
the channel. The <code class="inline">socket</code> holds information such as assigns and transport
configuration, so it&#39;s important to not copy this information outside of the
channel that owns it.</p>
<h2 id="reply/2-examples" class="section-heading">
  <a href="#reply/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="9160877367-1">(</span><span class="s">&quot;work&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="9160877367-1">)</span><span class="w"> </span><span class="k" data-group-id="9160877367-2">do</span><span class="w">
  </span><span class="nc">Worker</span><span class="o">.</span><span class="n">perform</span><span class="p" data-group-id="9160877367-3">(</span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket_ref</span><span class="p" data-group-id="9160877367-4">(</span><span class="n">socket</span><span class="p" data-group-id="9160877367-4">)</span><span class="p" data-group-id="9160877367-3">)</span><span class="w">
  </span><span class="p" data-group-id="9160877367-5">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="9160877367-5">}</span><span class="w">
</span><span class="k" data-group-id="9160877367-2">end</span><span class="w">

</span><span class="kd">def</span><span class="w"> </span><span class="nf">handle_info</span><span class="p" data-group-id="9160877367-6">(</span><span class="p" data-group-id="9160877367-7">{</span><span class="ss">:work_complete</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">,</span><span class="w"> </span><span class="n">ref</span><span class="p" data-group-id="9160877367-7">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="9160877367-6">)</span><span class="w"> </span><span class="k" data-group-id="9160877367-8">do</span><span class="w">
  </span><span class="n">reply</span><span class="p" data-group-id="9160877367-9">(</span><span class="n">ref</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9160877367-10">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="9160877367-10">}</span><span class="p" data-group-id="9160877367-9">)</span><span class="w">
  </span><span class="p" data-group-id="9160877367-11">{</span><span class="ss">:noreply</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="9160877367-11">}</span><span class="w">
</span><span class="k" data-group-id="9160877367-8">end</span></code></pre>
  </section>
</section>
<section class="detail" id="socket_ref/1">
  <div class="detail-header">
    <a href="#socket_ref/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">socket_ref(socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L579" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>socket_ref(<a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) :: <a href="#t:socket_ref/0">socket_ref</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Generates a <code class="inline">socket_ref</code> for an async reply.</p>
<p>See <a href="#reply/2"><code class="inline">reply/2</code></a> for example usage.</p>
  </section>
</section>
          </div>
        </section>
        <section id="callbacks" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#callbacks">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Callbacks          </h1>
          <div class="callbacks-list">
<section class="detail" id="c:code_change/3">
  <div class="detail-header">
    <a href="#c:code_change/3" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">code_change(old_vsn, arg2, extra)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L359" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>code_change(old_vsn, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>(), extra :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) ::
  {:ok, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()} | {:error, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}
when old_vsn: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>() | {:down, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
  </section>
</section>
<section class="detail" id="c:handle_call/3">
  <div class="detail-header">
    <a href="#c:handle_call/3" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">handle_call(msg, from, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L344" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>handle_call(
  msg :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
  from :: {<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pid</a>(), tag :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()},
  socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()
) ::
  {:reply, response :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Handle regular GenServer call messages.</p>
<p>See <a href="https://hexdocs.pm/elixir/GenServer.html#handle_call/3"><code class="inline">GenServer.handle_call/3</code></a>.</p>
  </section>
</section>
<section class="detail" id="c:handle_cast/2">
  <div class="detail-header">
    <a href="#c:handle_cast/2" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">handle_cast(msg, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L354" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>handle_cast(msg :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) ::
  {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()} | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Handle regular GenServer cast messages.</p>
<p>See <a href="https://hexdocs.pm/elixir/GenServer.html#handle_cast/2"><code class="inline">GenServer.handle_cast/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="c:handle_in/3">
  <div class="detail-header">
    <a href="#c:handle_in/3" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">handle_in(event, payload, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L313" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>handle_in(event :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), payload :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(), socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) ::
  {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">timeout</a>() | :hibernate}
  | {:reply, <a href="#t:reply/0">reply</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="#t:reply/0">reply</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Handle incoming <code class="inline">event</code>s.</p>
<h2 id="c:handle_in/3-example" class="section-heading">
  <a href="#c:handle_in/3-example" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Example
</h2>

<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">handle_in</span><span class="p" data-group-id="3223584620-1">(</span><span class="s">&quot;ping&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3223584620-1">)</span><span class="w"> </span><span class="k" data-group-id="3223584620-2">do</span><span class="w">
  </span><span class="p" data-group-id="3223584620-3">{</span><span class="ss">:reply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3223584620-4">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p" data-group-id="3223584620-4">}</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3223584620-3">}</span><span class="w">
</span><span class="k" data-group-id="3223584620-2">end</span></code></pre>
  </section>
</section>
<section class="detail" id="c:handle_info/2">
  <div class="detail-header">
    <a href="#c:handle_info/2" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">handle_info(msg, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L335" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>handle_info(msg :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) ::
  {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()} | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Handle regular Elixir process messages.</p>
<p>See <a href="https://hexdocs.pm/elixir/GenServer.html#handle_info/2"><code class="inline">GenServer.handle_info/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="c:handle_out/3">
  <div class="detail-header">
    <a href="#c:handle_out/3" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">handle_out(event, payload, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L325" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>handle_out(event :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>(), payload :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(), socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) ::
  {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:noreply, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">timeout</a>() | :hibernate}
  | {:stop, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Intercepts outgoing <code class="inline">event</code>s.</p>
<p>See <a href="#intercept/1"><code class="inline">intercept/1</code></a>.</p>
  </section>
</section>
<section class="detail" id="c:join/3">
  <div class="detail-header">
    <a href="#c:join/3" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">join(topic, payload, socket)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L298" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>join(topic :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), payload :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(), socket :: <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()) ::
  {:ok, <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:ok, reply :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>(), <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()}
  | {:error, reason :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Handle channel joins by <code class="inline">topic</code>.</p>
<p>To authorize a socket, return <code class="inline">{:ok, socket}</code> or <code class="inline">{:ok, reply, socket}</code>. To
refuse authorization, return <code class="inline">{:error, reason}</code>.</p>
<h2 id="c:join/3-example" class="section-heading">
  <a href="#c:join/3-example" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Example
</h2>

<pre><code class="nohighlight makeup elixir"><span class="kd">def</span><span class="w"> </span><span class="nf">join</span><span class="p" data-group-id="3737526558-1">(</span><span class="s">&quot;room:lobby&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">payload</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3737526558-1">)</span><span class="w"> </span><span class="k" data-group-id="3737526558-2">do</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="n">authorized?</span><span class="p" data-group-id="3737526558-3">(</span><span class="n">payload</span><span class="p" data-group-id="3737526558-3">)</span><span class="w"> </span><span class="k" data-group-id="3737526558-4">do</span><span class="w">
    </span><span class="p" data-group-id="3737526558-5">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">socket</span><span class="p" data-group-id="3737526558-5">}</span><span class="w">
  </span><span class="k" data-group-id="3737526558-4">else</span><span class="w">
    </span><span class="p" data-group-id="3737526558-6">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3737526558-7">%{</span><span class="ss">reason</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unauthorized&quot;</span><span class="p" data-group-id="3737526558-7">}</span><span class="p" data-group-id="3737526558-6">}</span><span class="w">
  </span><span class="k" data-group-id="3737526558-4">end</span><span class="w">
</span><span class="k" data-group-id="3737526558-2">end</span></code></pre>
  </section>
</section>
<section class="detail" id="c:terminate/2">
  <div class="detail-header">
    <a href="#c:terminate/2" class="detail-link" title="Link to this callback">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this callback</span>
    </a>
    <h1 class="signature">terminate(reason, arg2)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/channel.ex#L369" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(optional)</span>
      <div class="specs">
          <pre>terminate(
  reason :: :normal | :shutdown | {:shutdown, :left | :closed | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()},
  <a href="Phoenix.Socket.html#t:t/0">Phoenix.Socket.t</a>()
) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Invoked when the channel process is about to exit.</p>
<p>See <a href="https://hexdocs.pm/elixir/GenServer.html#terminate/2"><code class="inline">GenServer.terminate/2</code></a>.</p>
  </section>
</section>
          </div>
        </section>
      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.21.2),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
