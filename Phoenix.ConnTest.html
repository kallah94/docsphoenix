<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.21.2">
    <meta name="project" content="Phoenix v1.4.15">
    <title>Phoenix.ConnTest â€” Phoenix v1.4.15</title>
    <link rel="stylesheet" href="dist/html-de2388dc2f8074b0a4db.css" />
    <script src="dist/sidebar_items-c08200cd71.js"></script>
      <script src="docs_config.js"></script>
    <script async src="dist/html-de2388dc2f8074b0a4db.js"></script>
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button">
      <span class="icon-cross" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Search" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="http://www.phoenixframework.org" class="sidebar-projectName">
Phoenix      </a>
      <h2 class="sidebar-projectVersion">
        v1.4.15
      </h2>
    </div>
      <a href="http://www.phoenixframework.org">
        <img src="assets/logo.png" alt="Phoenix" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">GUIDES</a></li>

      <li><a id="modules-list" href="#full-list">Modules</a></li>

      <li><a id="exceptions-list" href="#full-list">Exceptions</a></li>

      <li><a id="tasks-list" href="#full-list">Mix Tasks</a></li>
  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
        <small class="app-vsn">Phoenix v1.4.15</small>
Phoenix.ConnTest          <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L1" title="View Source" class="view-source" rel="help">
            <span class="icon-code" aria-hidden="true"></span>
            <span class="sr-only">View Source</span>
          </a>
      </h1>


        <section id="moduledoc">
<p>Conveniences for testing Phoenix endpoints and connection related helpers.</p>
<p>You likely want to use this module or make it part of your <a href="https://hexdocs.pm/ex_unit/ExUnit.CaseTemplate.html"><code class="inline">ExUnit.CaseTemplate</code></a>.
Once used, this module automatically imports all functions defined here as
well as the functions in <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html"><code class="inline">Plug.Conn</code></a>.</p>
<h2 id="module-endpoint-testing" class="section-heading">
  <a href="#module-endpoint-testing" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Endpoint testing
</h2>

<p><a href="#content"><code class="inline">Phoenix.ConnTest</code></a> typically works against endpoints. That&#39;s the preferred way
to test anything that your router dispatches to:</p>
<pre><code class="nohighlight makeup elixir"><span class="na">@endpoint</span><span class="w"> </span><span class="nc">MyAppWeb.Endpoint</span><span class="w">

</span><span class="n">test</span><span class="w"> </span><span class="s">&quot;says welcome on the home page&quot;</span><span class="w"> </span><span class="k" data-group-id="4603966284-1">do</span><span class="w">
  </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="4603966284-2">(</span><span class="n">build_conn</span><span class="p" data-group-id="4603966284-3">(</span><span class="p" data-group-id="4603966284-3">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="4603966284-2">)</span><span class="w">
  </span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">resp_body</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;Welcome!&quot;</span><span class="w">
</span><span class="k" data-group-id="4603966284-1">end</span><span class="w">

</span><span class="n">test</span><span class="w"> </span><span class="s">&quot;logs in&quot;</span><span class="w"> </span><span class="k" data-group-id="4603966284-4">do</span><span class="w">
  </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">post</span><span class="p" data-group-id="4603966284-5">(</span><span class="n">build_conn</span><span class="p" data-group-id="4603966284-6">(</span><span class="p" data-group-id="4603966284-6">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/login&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4603966284-7">[</span><span class="ss">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;john&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;doe&quot;</span><span class="p" data-group-id="4603966284-7">]</span><span class="p" data-group-id="4603966284-5">)</span><span class="w">
  </span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">resp_body</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;Logged in!&quot;</span><span class="w">
</span><span class="k" data-group-id="4603966284-4">end</span></code></pre>
<p>The <code class="inline">@endpoint</code> module attribute contains the endpoint under testing,
most commonly your application endpoint itself. If you are using the
MyApp.ConnCase generated by Phoenix, it is automatically set for you.</p>
<p>As in your router and controllers, the connection is the main abstraction
in testing. <code class="inline">build_conn()</code> returns a new connection and functions in this
module can be used to manipulate the connection before dispatching
to the endpoint.</p>
<p>For example, one could set the accepts header for json requests as
follows:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">build_conn</span><span class="p" data-group-id="1673628680-1">(</span><span class="p" data-group-id="1673628680-1">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_req_header</span><span class="p" data-group-id="1673628680-2">(</span><span class="s">&quot;accept&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;application/json&quot;</span><span class="p" data-group-id="1673628680-2">)</span><span class="w">
</span><span class="o">|&gt;</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="1673628680-3">(</span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="1673628680-3">)</span></code></pre>
<p>You can also create your own helpers, such as <code class="inline">json_conn()</code> that uses
<a href="#build_conn/0"><code class="inline">build_conn/0</code></a> and <code class="inline">put_req_header/3</code>, so you avoid repeating the connection
setup throughout your tests.</p>
<h2 id="module-controller-testing" class="section-heading">
  <a href="#module-controller-testing" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Controller testing
</h2>

<p>The functions in this module can also be used for controller testing.
While endpoint testing is preferred over controller testing, especially
since the controller in Phoenix plays an integration role between your
domain and your views, unit testing controllers may be helpful in some
situations.</p>
<p>For such cases, you need to set the <code class="inline">@endpoint</code> attribute to your controller
and pass an atom representing the action to dispatch:</p>
<pre><code class="nohighlight makeup elixir"><span class="na">@endpoint</span><span class="w"> </span><span class="nc">MyAppWeb.HomeController</span><span class="w">

</span><span class="n">test</span><span class="w"> </span><span class="s">&quot;says welcome on the home page&quot;</span><span class="w"> </span><span class="k" data-group-id="2179038178-1">do</span><span class="w">
  </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="2179038178-2">(</span><span class="n">build_conn</span><span class="p" data-group-id="2179038178-3">(</span><span class="p" data-group-id="2179038178-3">)</span><span class="p">,</span><span class="w"> </span><span class="ss">:index</span><span class="p" data-group-id="2179038178-2">)</span><span class="w">
  </span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">resp_body</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;Welcome!&quot;</span><span class="w">
</span><span class="k" data-group-id="2179038178-1">end</span></code></pre>
<p>Keep in mind that, once the <code class="inline">@endpoint</code> variable is set, all tests after
setting it will be affected.</p>
<h2 id="module-views-testing" class="section-heading">
  <a href="#module-views-testing" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Views testing
</h2>

<p>Under other circumstances, you may be testing a view or another layer that
requires a connection for processing. For such cases, a connection can be
created using the <a href="#conn/3"><code class="inline">conn/3</code></a> helper:</p>
<pre><code class="nohighlight makeup elixir"><span class="nc">MyApp.UserView</span><span class="o">.</span><span class="n">render</span><span class="p" data-group-id="5090655275-1">(</span><span class="s">&quot;hello.html&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">conn</span><span class="p">:</span><span class="w"> </span><span class="n">build_conn</span><span class="p" data-group-id="5090655275-2">(</span><span class="ss">:get</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="5090655275-2">)</span><span class="p" data-group-id="5090655275-1">)</span></code></pre>
<p>While <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> returns a connection with no request information to it,
<a href="#build_conn/2"><code class="inline">build_conn/2</code></a> returns a connection with the given request information already
filled in.</p>
<h2 id="module-recycling" class="section-heading">
  <a href="#module-recycling" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Recycling
</h2>

<p>Browsers implement a storage by using cookies. When a cookie is set in the
response, the browser stores it and sends it in the next request.</p>
<p>To emulate this behaviour, this module provides the idea of recycling.
The <a href="#recycle/1"><code class="inline">recycle/1</code></a> function receives a connection and returns a new connection,
similar to the one returned by <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> with all the response cookies
from the previous connection defined as request headers. This is useful when
testing multiple routes that require cookies or session to work.</p>
<p>Keep in mind Phoenix will automatically recycle the connection between
dispatches. This usually works out well most times, but it may discard
information if you are modifying the connection before the next dispatch:</p>
<pre><code class="nohighlight makeup elixir"><span class="c1"># No recycling as the connection is fresh</span><span class="w">
</span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="8540623470-1">(</span><span class="n">build_conn</span><span class="p" data-group-id="8540623470-2">(</span><span class="p" data-group-id="8540623470-2">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="8540623470-1">)</span><span class="w">

</span><span class="c1"># The connection is recycled, creating a new one behind the scenes</span><span class="w">
</span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">post</span><span class="p" data-group-id="8540623470-3">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/login&quot;</span><span class="p" data-group-id="8540623470-3">)</span><span class="w">

</span><span class="c1"># We can also recycle manually in case we want custom headers</span><span class="w">
</span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">conn</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">recycle</span><span class="p" data-group-id="8540623470-4">(</span><span class="p" data-group-id="8540623470-4">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_req_header</span><span class="p" data-group-id="8540623470-5">(</span><span class="s">&quot;x-special&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nice&quot;</span><span class="p" data-group-id="8540623470-5">)</span><span class="w">

</span><span class="c1"># No recycling as we did it explicitly</span><span class="w">
</span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delete</span><span class="p" data-group-id="8540623470-6">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/logout&quot;</span><span class="p" data-group-id="8540623470-6">)</span></code></pre>
<p>Recycling also recycles the &quot;accept&quot; and &quot;authorization&quot; headers,
as well as peer data information.</p>
        </section>

        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#assert_error_sent/2">assert_error_sent(status_int_or_atom, func)</a>
  </div>
    <div class="summary-synopsis"><p>Asserts an error was wrapped and sent with the given status.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#build_conn/0">build_conn()</a>
  </div>
    <div class="summary-synopsis"><p>Creates a connection to be used in upcoming requests.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#build_conn/3">build_conn(method, path, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Creates a connection to be used in upcoming requests
with a preset method, path and body.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#bypass_through/1">bypass_through(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Calls the Endpoint and Router pipelines.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#bypass_through/2">bypass_through(conn, router)</a>
  </div>
    <div class="summary-synopsis"><p>Calls the Endpoint and Router pipelines for the current route.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#bypass_through/3">bypass_through(conn, router, pipelines)</a>
  </div>
    <div class="summary-synopsis"><p>Calls the Endpoint and the given Router pipelines.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#clear_flash/1">clear_flash(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Clears up the flash storage.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#conn/0">conn()</a>
  </div>
    <div class="summary-synopsis"><p>Deprecated version of <a href="#conn/0"><code class="inline">conn/0</code></a>. Use <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> instead.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#conn/3">conn(method, path, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Deprecated version of <a href="#conn/3"><code class="inline">conn/3</code></a>. Use <a href="#build_conn/3"><code class="inline">build_conn/3</code></a> instead.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#connect/3">connect(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#delete/3">delete(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#delete_req_cookie/2">delete_req_cookie(conn, key)</a>
  </div>
    <div class="summary-synopsis"><p>Deletes a request cookie.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#dispatch/5">dispatch(conn, endpoint, method, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches the connection to the given endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#ensure_recycled/1">ensure_recycled(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Ensures the connection is recycled if it wasn&#39;t already.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#fetch_flash/1">fetch_flash(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Fetches the flash storage.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#get/3">get(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#get_flash/1">get_flash(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Gets the whole flash storage.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#get_flash/2">get_flash(conn, key)</a>
  </div>
    <div class="summary-synopsis"><p>Gets the given key from the flash storage.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#head/3">head(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#html_response/2">html_response(conn, status)</a>
  </div>
    <div class="summary-synopsis"><p>Asserts the given status code, that we have an html response and
returns the response body if one was set or sent.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#json_response/2">json_response(conn, status)</a>
  </div>
    <div class="summary-synopsis"><p>Asserts the given status code, that we have a json response and
returns the decoded JSON response if one was set or sent.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#options/3">options(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#patch/3">patch(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#post/3">post(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#put/3">put(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#put_flash/3">put_flash(conn, key, value)</a>
  </div>
    <div class="summary-synopsis"><p>Puts the given value under key in the flash storage.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#put_req_cookie/3">put_req_cookie(conn, key, value)</a>
  </div>
    <div class="summary-synopsis"><p>Puts a request cookie.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#recycle/2">recycle(conn, headers \\ ~w(accept accept-language authorization))</a>
  </div>
    <div class="summary-synopsis"><p>Recycles the connection.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#redirected_params/1">redirected_params(conn)</a>
  </div>
    <div class="summary-synopsis"><p>Returns the matched params from the URL the connection was redirected to.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#redirected_to/2">redirected_to(conn, status \\ 302)</a>
  </div>
    <div class="summary-synopsis"><p>Returns the location header from the given redirect response.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#response/2">response(conn, given)</a>
  </div>
    <div class="summary-synopsis"><p>Asserts the given status code and returns the response body
if one was set or sent.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#response_content_type/2">response_content_type(conn, format)</a>
  </div>
    <div class="summary-synopsis"><p>Returns the content type as long as it matches the given format.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#text_response/2">text_response(conn, status)</a>
  </div>
    <div class="summary-synopsis"><p>Asserts the given status code, that we have a text response and
returns the response body if one was set or sent.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#trace/3">trace(conn, path_or_action, params_or_body \\ nil)</a>
  </div>
    <div class="summary-synopsis"><p>Dispatches to the current endpoint.</p></div>
</div>
  </div>
        </section>

        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions          </h1>
          <div class="functions-list">
<section class="detail" id="assert_error_sent/2">
  <div class="detail-header">
    <a href="#assert_error_sent/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">assert_error_sent(status_int_or_atom, func)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L625" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>assert_error_sent(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">function</a>()) :: {<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}</pre>
      </div>
  </div>
  <section class="docstring">
<p>Asserts an error was wrapped and sent with the given status.</p>
<p>Useful for testing actions that you expect raise an error and have
the response wrapped in an HTTP status, with content usually rendered
by your MyApp.ErrorView.</p>
<p>The function accepts a status either as an integer HTTP status or
atom, such as <code class="inline">404</code> or <code class="inline">:not_found</code>. The list of allowed atoms is available
in <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.Status.html"><code class="inline">Plug.Conn.Status</code></a>. If an error is raised, a 3-tuple of the wrapped
response is returned matching the status, headers, and body of the response:</p>
<pre><code class="nohighlight makeup elixir"><span class="p" data-group-id="7285599768-1">{</span><span class="mi">404</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7285599768-2">[</span><span class="p" data-group-id="7285599768-3">{</span><span class="s">&quot;content-type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;text/html&quot;</span><span class="p" data-group-id="7285599768-3">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="7285599768-2">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Page not found&quot;</span><span class="p" data-group-id="7285599768-1">}</span></code></pre>
<h2 id="assert_error_sent/2-examples" class="section-heading">
  <a href="#assert_error_sent/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">assert_error_sent</span><span class="w"> </span><span class="ss">:not_found</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9956292907-1">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">get</span><span class="p" data-group-id="9956292907-2">(</span><span class="n">build_conn</span><span class="p" data-group-id="9956292907-3">(</span><span class="p" data-group-id="9956292907-3">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/users/not-found&quot;</span><span class="p" data-group-id="9956292907-2">)</span><span class="w">
</span><span class="k" data-group-id="9956292907-1">end</span><span class="w">

</span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">assert_error_sent</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="9956292907-4">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">
  </span><span class="n">get</span><span class="p" data-group-id="9956292907-5">(</span><span class="n">build_conn</span><span class="p" data-group-id="9956292907-6">(</span><span class="p" data-group-id="9956292907-6">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/users/not-found&quot;</span><span class="p" data-group-id="9956292907-5">)</span><span class="w">
</span><span class="k" data-group-id="9956292907-4">end</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="p" data-group-id="9956292907-7">{</span><span class="mi">404</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9956292907-8">[</span><span class="c">_h</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="c">_t</span><span class="p" data-group-id="9956292907-8">]</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Page not found&quot;</span><span class="p" data-group-id="9956292907-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">response</span></code></pre>
  </section>
</section>
<section class="detail" id="build_conn/0">
  <div class="detail-header">
    <a href="#build_conn/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">build_conn()</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L128" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>build_conn() :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Creates a connection to be used in upcoming requests.</p>
  </section>
</section>
<section class="detail" id="build_conn/3">
    <span id="build_conn/2"></span>
  <div class="detail-header">
    <a href="#build_conn/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">build_conn(method, path, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L149" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>build_conn(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | nil) ::
  <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Creates a connection to be used in upcoming requests
with a preset method, path and body.</p>
<p>This is useful when a specific connection is required
for testing a plug or a particular function.</p>
  </section>
</section>
<section class="detail" id="bypass_through/1">
  <div class="detail-header">
    <a href="#bypass_through/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">bypass_through(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L551" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>bypass_through(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Calls the Endpoint and Router pipelines.</p>
<p>Useful for unit testing Plugs where Endpoint and/or router pipeline
plugs are required for proper setup.</p>
<p>Note the use of <code class="inline">get(&quot;/&quot;)</code> following <code class="inline">bypass_through</code> in the examples below.
To execute the plug pipelines, you must issue a request against the router.
Most often, you can simply send a GET request against the root path, but you
may also specify a different method or path which your pipelines may operate
against.</p>
<h2 id="bypass_through/1-examples" class="section-heading">
  <a href="#bypass_through/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<p>For example, imagine you are testing an authentication plug in
isolation, but you need to invoke the Endpoint plugs and router
Ripelines to set up session and flash related dependencies.
One option is to invoke an existing route that uses the proper
pipelines. You can do so by passing the connection and the
router name to <code class="inline">bypass_through</code>:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">conn</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bypass_through</span><span class="p" data-group-id="4403437711-1">(</span><span class="nc">MyAppWeb.Router</span><span class="p" data-group-id="4403437711-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="4403437711-2">(</span><span class="s">&quot;/some_url&quot;</span><span class="p" data-group-id="4403437711-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">MyApp.RequireAuthentication</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="4403437711-3">(</span><span class="p" data-group-id="4403437711-4">[</span><span class="p" data-group-id="4403437711-4">]</span><span class="p" data-group-id="4403437711-3">)</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">halted</span></code></pre>
<p>You can also specify which pipelines you want to run:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">conn</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bypass_through</span><span class="p" data-group-id="9915502815-1">(</span><span class="nc">MyAppWeb.Router</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9915502815-2">[</span><span class="ss">:browser</span><span class="p" data-group-id="9915502815-2">]</span><span class="p" data-group-id="9915502815-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="9915502815-3">(</span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="9915502815-3">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">MyApp.RequireAuthentication</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="9915502815-4">(</span><span class="p" data-group-id="9915502815-5">[</span><span class="p" data-group-id="9915502815-5">]</span><span class="p" data-group-id="9915502815-4">)</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">halted</span></code></pre>
<p>Alternatively, you could only invoke the Endpoint&#39;s plugs:</p>
<pre><code class="nohighlight makeup elixir"><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w">
  </span><span class="n">conn</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">bypass_through</span><span class="p" data-group-id="8899836303-1">(</span><span class="p" data-group-id="8899836303-1">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="8899836303-2">(</span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="8899836303-2">)</span><span class="w">
  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">MyApp.RequireAuthentication</span><span class="o">.</span><span class="n">call</span><span class="p" data-group-id="8899836303-3">(</span><span class="p" data-group-id="8899836303-4">[</span><span class="p" data-group-id="8899836303-4">]</span><span class="p" data-group-id="8899836303-3">)</span><span class="w">

</span><span class="n">assert</span><span class="w"> </span><span class="n">conn</span><span class="o">.</span><span class="n">halted</span></code></pre>
  </section>
</section>
<section class="detail" id="bypass_through/2">
  <div class="detail-header">
    <a href="#bypass_through/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">bypass_through(conn, router)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L561" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>bypass_through(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Calls the Endpoint and Router pipelines for the current route.</p>
<p>See <a href="#bypass_through/1"><code class="inline">bypass_through/1</code></a>.</p>
  </section>
</section>
<section class="detail" id="bypass_through/3">
  <div class="detail-header">
    <a href="#bypass_through/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">bypass_through(conn, router, pipelines)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L571" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>bypass_through(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Calls the Endpoint and the given Router pipelines.</p>
<p>See <a href="#bypass_through/1"><code class="inline">bypass_through/1</code></a>.</p>
  </section>
</section>
<section class="detail" id="clear_flash/1">
  <div class="detail-header">
    <a href="#clear_flash/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">clear_flash(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L299" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>clear_flash(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Clears up the flash storage.</p>
  </section>
</section>
<section class="detail" id="conn/0">
  <div class="detail-header">
    <a href="#conn/0" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">conn()</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L136" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>conn() :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Deprecated version of <a href="#conn/0"><code class="inline">conn/0</code></a>. Use <a href="#build_conn/0"><code class="inline">build_conn/0</code></a> instead.</p>
  </section>
</section>
<section class="detail" id="conn/3">
    <span id="conn/2"></span>
  <div class="detail-header">
    <a href="#conn/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">conn(method, path, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L159" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>conn(<a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">list</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | nil) ::
  <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Deprecated version of <a href="#conn/3"><code class="inline">conn/3</code></a>. Use <a href="#build_conn/3"><code class="inline">build_conn/3</code></a> instead.</p>
  </section>
</section>
<section class="detail" id="connect/3">
    <span id="connect/2"></span>
  <div class="detail-header">
    <a href="#connect/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">connect(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="delete/3">
    <span id="delete/2"></span>
  <div class="detail-header">
    <a href="#delete/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">delete(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="delete_req_cookie/2">
  <div class="detail-header">
    <a href="#delete_req_cookie/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">delete_req_cookie(conn, key)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L269" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>delete_req_cookie(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Deletes a request cookie.</p>
  </section>
</section>
<section class="detail" id="dispatch/5">
    <span id="dispatch/4"></span>
  <div class="detail-header">
    <a href="#dispatch/5" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">dispatch(conn, endpoint, method, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L222" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
  </div>
  <section class="docstring">
<p>Dispatches the connection to the given endpoint.</p>
<p>When invoked via <a href="#get/3"><code class="inline">get/3</code></a>, <a href="#post/3"><code class="inline">post/3</code></a> and friends, the endpoint
is automatically retrieved from the <code class="inline">@endpoint</code> module
attribute, otherwise it must be given as an argument.</p>
<p>The connection will be configured with the given <code class="inline">method</code>,
<code class="inline">path_or_action</code> and <code class="inline">params_or_body</code>.</p>
<p>If <code class="inline">path_or_action</code> is a string, it is considered to be the
request path and stored as so in the connection. If an atom,
it is assumed to be an action and the connection is dispatched
to the given action.</p>
<h2 id="dispatch/5-parameters-and-body" class="section-heading">
  <a href="#dispatch/5-parameters-and-body" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Parameters and body
</h2>

<p>This function, as well as <a href="#get/3"><code class="inline">get/3</code></a>, <a href="#post/3"><code class="inline">post/3</code></a> and friends, accepts the
request body or parameters as last argument:</p>
<pre><code class="nohighlight makeup elixir"><span class="w">  </span><span class="n">get</span><span class="p" data-group-id="7004447063-1">(</span><span class="n">build_conn</span><span class="p" data-group-id="7004447063-2">(</span><span class="p" data-group-id="7004447063-2">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">some</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;param&quot;</span><span class="p" data-group-id="7004447063-1">)</span><span class="w">
  </span><span class="n">get</span><span class="p" data-group-id="7004447063-3">(</span><span class="n">build_conn</span><span class="p" data-group-id="7004447063-4">(</span><span class="p" data-group-id="7004447063-4">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;some=param&amp;url=encoded&quot;</span><span class="p" data-group-id="7004447063-3">)</span></code></pre>
<p>The allowed values are:</p>
<ul>
<li><p><code class="inline">nil</code> - meaning there is no body</p>
</li>
<li><p>a binary - containing a request body. For such cases, <code class="inline">:headers</code>
must be given as option with a content-type</p>
</li>
<li><p>a map or list - containing the parameters which will automatically
set the content-type to multipart. The map or list may contain
other lists or maps and all entries will be normalized to string
keys</p>
</li>
<li><p>a struct - unlike other maps, a struct will be passed through as-is
without normalizing its entries</p>
</li>
</ul>
  </section>
</section>
<section class="detail" id="ensure_recycled/1">
  <div class="detail-header">
    <a href="#ensure_recycled/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">ensure_recycled(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L495" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>ensure_recycled(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Ensures the connection is recycled if it wasn&#39;t already.</p>
<p>See <a href="#recycle/1"><code class="inline">recycle/1</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="fetch_flash/1">
  <div class="detail-header">
    <a href="#fetch_flash/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">fetch_flash(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L275" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>fetch_flash(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Fetches the flash storage.</p>
  </section>
</section>
<section class="detail" id="get/3">
    <span id="get/2"></span>
  <div class="detail-header">
    <a href="#get/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">get(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="get_flash/1">
  <div class="detail-header">
    <a href="#get_flash/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">get_flash(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L281" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>get_flash(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Gets the whole flash storage.</p>
  </section>
</section>
<section class="detail" id="get_flash/2">
  <div class="detail-header">
    <a href="#get_flash/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">get_flash(conn, key)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L287" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>get_flash(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Gets the given key from the flash storage.</p>
  </section>
</section>
<section class="detail" id="head/3">
    <span id="head/2"></span>
  <div class="detail-header">
    <a href="#head/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">head(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="html_response/2">
  <div class="detail-header">
    <a href="#html_response/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">html_response(conn, status)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L386" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>html_response(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) ::
  <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">no_return</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Asserts the given status code, that we have an html response and
returns the response body if one was set or sent.</p>
<h2 id="html_response/2-examples" class="section-heading">
  <a href="#html_response/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">assert</span><span class="w"> </span><span class="n">html_response</span><span class="p" data-group-id="1521343072-1">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p" data-group-id="1521343072-1">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;&lt;html&gt;&quot;</span></code></pre>
  </section>
</section>
<section class="detail" id="json_response/2">
  <div class="detail-header">
    <a href="#json_response/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">json_response(conn, status)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L418" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>json_response(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) ::
  <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">no_return</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Asserts the given status code, that we have a json response and
returns the decoded JSON response if one was set or sent.</p>
<h2 id="json_response/2-examples" class="section-heading">
  <a href="#json_response/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json_response</span><span class="p" data-group-id="8170154692-1">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p" data-group-id="8170154692-1">)</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="s">&quot;can&#39;t be blank&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">body</span><span class="p" data-group-id="8170154692-2">[</span><span class="s">&quot;errors&quot;</span><span class="p" data-group-id="8170154692-2">]</span></code></pre>
  </section>
</section>
<section class="detail" id="options/3">
    <span id="options/2"></span>
  <div class="detail-header">
    <a href="#options/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">options(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="patch/3">
    <span id="patch/2"></span>
  <div class="detail-header">
    <a href="#patch/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">patch(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="post/3">
    <span id="post/2"></span>
  <div class="detail-header">
    <a href="#post/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">post(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="put/3">
    <span id="put/2"></span>
  <div class="detail-header">
    <a href="#put/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">put(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
<section class="detail" id="put_flash/3">
  <div class="detail-header">
    <a href="#put_flash/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">put_flash(conn, key, value)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L293" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>put_flash(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Puts the given value under key in the flash storage.</p>
  </section>
</section>
<section class="detail" id="put_req_cookie/3">
  <div class="detail-header">
    <a href="#put_req_cookie/3" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">put_req_cookie(conn, key, value)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L263" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>put_req_cookie(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>()) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Puts a request cookie.</p>
  </section>
</section>
<section class="detail" id="recycle/2">
    <span id="recycle/1"></span>
  <div class="detail-header">
    <a href="#recycle/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">recycle(conn, headers \\ ~w(accept accept-language authorization))</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L476" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>recycle(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), [<a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()]) :: <a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Recycles the connection.</p>
<p>Recycling receives a connection and returns a new connection,
containing cookies and relevant information from the given one.</p>
<p>This emulates behaviour performed by browsers where cookies
returned in the response are available in following requests.</p>
<p>By default, only the headers &quot;accept&quot;, &quot;accept-language&quot;, and
&quot;authorization&quot; are recycled. However, a custom set of headers
can be specified by passing a list of strings representing its
names as the second argument of the function.</p>
<p>Note <a href="#recycle/1"><code class="inline">recycle/1</code></a> is automatically invoked when dispatching
to the endpoint, unless the connection has already been
recycled.</p>
  </section>
</section>
<section class="detail" id="redirected_params/1">
  <div class="detail-header">
    <a href="#redirected_params/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">redirected_params(conn)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L587" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>redirected_params(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">map</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Returns the matched params from the URL the connection was redirected to.</p>
<p>Uses the provided <code class="inline">%Plug.Conn{}</code>s router matched in the previous request.
Raises if the response&#39;s location header is not set.</p>
<h2 id="redirected_params/1-examples" class="section-heading">
  <a href="#redirected_params/1-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">assert</span><span class="w"> </span><span class="n">redirected_to</span><span class="p" data-group-id="5960631221-1">(</span><span class="n">conn</span><span class="p" data-group-id="5960631221-1">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;/posts/123&quot;</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="p" data-group-id="5960631221-2">%{</span><span class="ss">id</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;123&quot;</span><span class="p" data-group-id="5960631221-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">redirected_params</span><span class="p" data-group-id="5960631221-3">(</span><span class="n">conn</span><span class="p" data-group-id="5960631221-3">)</span></code></pre>
  </section>
</section>
<section class="detail" id="redirected_to/2">
    <span id="redirected_to/1"></span>
  <div class="detail-header">
    <a href="#redirected_to/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">redirected_to(conn, status \\ 302)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L438" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>redirected_to(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">non_neg_integer</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Returns the location header from the given redirect response.</p>
<p>Raises if the response does not match the redirect status code
(defaults to 302).</p>
<h2 id="redirected_to/2-examples" class="section-heading">
  <a href="#redirected_to/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">assert</span><span class="w"> </span><span class="n">redirected_to</span><span class="p" data-group-id="7885499865-1">(</span><span class="n">conn</span><span class="p" data-group-id="7885499865-1">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;/foo/bar&quot;</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">redirected_to</span><span class="p" data-group-id="7885499865-2">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="mi">301</span><span class="p" data-group-id="7885499865-2">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;/foo/bar&quot;</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">redirected_to</span><span class="p" data-group-id="7885499865-3">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="ss">:moved_permanently</span><span class="p" data-group-id="7885499865-3">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;/foo/bar&quot;</span></code></pre>
  </section>
</section>
<section class="detail" id="response/2">
  <div class="detail-header">
    <a href="#response/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">response(conn, given)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L357" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>response(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">binary</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">no_return</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Asserts the given status code and returns the response body
if one was set or sent.</p>
<h2 id="response/2-examples" class="section-heading">
  <a href="#response/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get</span><span class="p" data-group-id="6553612298-1">(</span><span class="n">build_conn</span><span class="p" data-group-id="6553612298-2">(</span><span class="p" data-group-id="6553612298-2">)</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p" data-group-id="6553612298-1">)</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">response</span><span class="p" data-group-id="6553612298-3">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p" data-group-id="6553612298-3">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;hello world&quot;</span></code></pre>
  </section>
</section>
<section class="detail" id="response_content_type/2">
  <div class="detail-header">
    <a href="#response_content_type/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">response_content_type(conn, format)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L311" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>response_content_type(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) :: <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">no_return</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Returns the content type as long as it matches the given format.</p>
<h2 id="response_content_type/2-examples" class="section-heading">
  <a href="#response_content_type/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="c1"># Assert we have an html response with utf-8 charset</span><span class="w">
</span><span class="n">assert</span><span class="w"> </span><span class="n">response_content_type</span><span class="p" data-group-id="2222835638-1">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="ss">:html</span><span class="p" data-group-id="2222835638-1">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;charset=utf-8&quot;</span></code></pre>
  </section>
</section>
<section class="detail" id="text_response/2">
  <div class="detail-header">
    <a href="#text_response/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">text_response(conn, status)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L401" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <div class="specs">
          <pre>text_response(<a href="https://hexdocs.pm/plug/1.8.3/Plug.Conn.html#t:t/0">Plug.Conn.t</a>(), status :: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">integer</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>()) ::
  <a href="https://hexdocs.pm/elixir/String.html#t:t/0">String.t</a>() | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">no_return</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p>Asserts the given status code, that we have a text response and
returns the response body if one was set or sent.</p>
<h2 id="text_response/2-examples" class="section-heading">
  <a href="#text_response/2-examples" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Examples
</h2>

<pre><code class="nohighlight makeup elixir"><span class="n">assert</span><span class="w"> </span><span class="n">text_response</span><span class="p" data-group-id="2952773181-1">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p" data-group-id="2952773181-1">)</span><span class="w"> </span><span class="o">=~</span><span class="w"> </span><span class="s">&quot;hello&quot;</span></code></pre>
  </section>
</section>
<section class="detail" id="trace/3">
    <span id="trace/2"></span>
  <div class="detail-header">
    <a href="#trace/3" class="detail-link" title="Link to this macro">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this macro</span>
    </a>
    <h1 class="signature">trace(conn, path_or_action, params_or_body \\ nil)</h1>
      <a href="https://github.com/phoenixframework/phoenix/blob/v1.4.15/lib/phoenix/test/conn_test.ex#L175" class="view-source" rel="help" title="View Source">
       <span class="icon-code" aria-hidden="true"></span>
       <span class="sr-only">View Source</span>
     </a>
      <span class="note">(macro)</span>
  </div>
  <section class="docstring">
<p>Dispatches to the current endpoint.</p>
<p>See <a href="#dispatch/5"><code class="inline">dispatch/5</code></a> for more information.</p>
  </section>
</section>
          </div>
        </section>
      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.21.2),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
